# ä»·æ ¼åˆ†ç±»å­˜å‚¨æ–¹æ¡ˆ - Walkthrough

> **å®Œæˆæ—¥æœŸ**: 2026-01-19
> **æœ€åæ›´æ–°**: 2026-01-22
> **æ ¸å¿ƒæ”¹åŠ¨**: å®ç°ä¼ä¸šä»·æ ¼ vs åœ°åŸŸä»·æ ¼ vs æ¸¯å£ä»·æ ¼çš„ä¸‰ç»´åˆ†ç±»å­˜å‚¨

---

## ğŸ“‹ å˜æ›´æ¦‚è§ˆ

æœ¬æ¬¡æ›´æ–°å®ç°äº†ä»·æ ¼æ•°æ®çš„ä¸‰ç»´åº¦åˆ†ç±»å­˜å‚¨ï¼Œé…åˆé‡‡é›†ç‚¹é…ç½®å’Œè¡Œæ”¿åŒºåˆ’ï¼Œå½¢æˆå®Œæ•´çš„ä»·æ ¼æ•°æ®ç®¡ç†ä½“ç³»ã€‚

```mermaid
graph TB
    subgraph ä»·æ ¼åˆ†ç±»ä½“ç³»
        A[ä»·æ ¼æ•°æ®] --> B{ä¸»ä½“ç±»å‹ SourceType}
        B --> C[ğŸ­ ENTERPRISE ä¼ä¸šæ”¶è´­ä»·]
        B --> D[âš“ PORT æ¸¯å£ä»·æ ¼]
        B --> E[ğŸŒ REGIONAL åœ°åŸŸå¸‚åœºä»·]
        
        A --> F{å­ç±»å‹ SubType}
        F --> G[LISTED æŒ‚ç‰Œä»·]
        F --> H[TRANSACTION æˆäº¤ä»·]
        F --> I[ARRIVAL åˆ°æ¸¯ä»·]
        F --> J[FOB å¹³èˆ±ä»·]
        F --> K[STATION_ORIGIN ç«™å°ä»·-äº§åŒº]
        F --> L[PURCHASE æ”¶è´­ä»·]
        
        A --> M{åœ°ç†å±‚çº§ GeoLevel}
        M --> N[ENTERPRISE / PORT / CITY / PROVINCE / REGION]
    end
```

---

## ğŸ—ƒï¸ æ•°æ®åº“æ¨¡å‹

### PriceData è¡¨ç»“æ„

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
| :--- | :--- | :--- |
| `sourceType` | PriceSourceType | ä»·æ ¼ä¸»ä½“ç±»å‹ |
| `subType` | PriceSubType | ä»·æ ¼å­ç±»å‹ |
| `geoLevel` | GeoLevel | åœ°ç†å±‚çº§ |
| `location` | String | é‡‡é›†ç‚¹åç§° |
| `collectionPointId` | String? | å…³è”é‡‡é›†ç‚¹é…ç½® |
| `regionCode` | String? | å…³è”è¡Œæ”¿åŒºåˆ’ |
| `enterpriseId` | String? | å…³è”ä¼ä¸šï¼ˆä¼ä¸šä»·æ ¼ï¼‰ |
| `effectiveDate` | Date | ä»·æ ¼æ—¥æœŸ |
| `commodity` | String | å“ç§ |
| `price` | Decimal | ä»·æ ¼ï¼ˆå…ƒ/å¨ï¼‰ |
| `dayChange` | Decimal? | è¾ƒæ˜¨æ—¥æ¶¨è·Œ |

### æšä¸¾å®šä¹‰

#### PriceSourceType

| å€¼ | è¯´æ˜ |
| :--- | :--- |
| `ENTERPRISE` | ä¼ä¸šæ”¶è´­ä»·ï¼ˆå…·ä½“ä¼ä¸šçš„æŒ‚ç‰Œ/æˆäº¤ä»·ï¼‰ |
| `REGIONAL` | åœ°åŸŸå¸‚åœºä»·ï¼ˆåŒºåŸŸç»¼åˆä»·æ ¼ï¼‰ |
| `PORT` | æ¸¯å£ä»·æ ¼ï¼ˆåˆ°æ¸¯/å¹³èˆ±ä»·ï¼‰ |

#### PriceSubType

| å€¼ | è¯´æ˜ |
| :--- | :--- |
| `LISTED` | æŒ‚ç‰Œä»·ï¼ˆä¼ä¸šå¯¹å¤–å…¬å¸ƒï¼‰ |
| `TRANSACTION` | æˆäº¤ä»·ï¼ˆå®é™…æˆäº¤ï¼‰ |
| `ARRIVAL` | åˆ°æ¸¯ä»·ï¼ˆåˆ°è¾¾æ¸¯å£çš„ä»·æ ¼ï¼‰ |
| `FOB` | å¹³èˆ±ä»·ï¼ˆèˆ¹èˆ±äº¤è´§ä»·ï¼‰ |
| `STATION_ORIGIN` | ç«™å°ä»·-äº§åŒºï¼ˆä¸œåŒ—ç«™å°å‘è´§ä»·ï¼‰ |
| `STATION_DEST` | ç«™å°ä»·-é”€åŒºï¼ˆé”€åŒºç«™å°åˆ°è´§ä»·ï¼‰ |
| `PURCHASE` | æ”¶è´­ä»·ï¼ˆå‘å†œæˆ·/è´¸æ˜“å•†æ”¶è´­ï¼‰ |
| `WHOLESALE` | æ‰¹å‘ä»·ï¼ˆæ‰¹å‘å¸‚åœºä»·æ ¼ï¼‰ |

#### GeoLevel

| å€¼ | è¯´æ˜ |
| :--- | :--- |
| `COUNTRY` | å›½å®¶çº§ |
| `REGION` | å¤§åŒºï¼ˆä¸œåŒ—/ååŒ—ç­‰ï¼‰ |
| `PROVINCE` | çœçº§ |
| `CITY` | å¸‚çº§ |
| `DISTRICT` | åŒºå¿çº§ |
| `PORT` | æ¸¯å£ |
| `STATION` | ç«™å° |
| `ENTERPRISE` | ä¼ä¸šç‚¹ä½ |

---

## âš™ï¸ é‡‡é›†ç‚¹é…ç½®

### CollectionPoint è¡¨

æ”¯æŒé‡‡é›†ç‚¹çš„ç»Ÿä¸€é…ç½®ç®¡ç†ï¼š

| å­—æ®µ | è¯´æ˜ |
| :--- | :--- |
| `code` | å”¯ä¸€ç¼–ç ï¼ˆå¦‚ JINZHOU_PORTï¼‰ |
| `name` | æ˜¾ç¤ºåç§° |
| `aliases` | åˆ«ååˆ—è¡¨ï¼ˆAI æ¨¡ç³ŠåŒ¹é…ï¼‰ |
| `type` | ENTERPRISE / PORT / STATION / REGION / MARKET |
| `regionCode` | å…³è”è¡Œæ”¿åŒºåˆ’ |
| `priceSubTypes` | æ”¯æŒçš„ä»·æ ¼ç±»å‹åˆ—è¡¨ |
| `defaultSubType` | é»˜è®¤ä»·æ ¼å­ç±»å‹ |
| `commodities` | ä¸»è¥å“ç§ |
| `matchKeywords` | åŒ¹é…å…³é”®è¯ |

### é‡‡é›†ç‚¹ç¤ºä¾‹

| åç§° | ç±»å‹ | é»˜è®¤å­ç±»å‹ | è¯´æ˜ |
| :--- | :--- | :--- | :--- |
| é”¦å·æ¸¯ | PORT | FOB | å¹³èˆ±ä»· |
| é²…é±¼åœˆ | PORT | ARRIVAL | åˆ°æ¸¯ä»· |
| æ¢…èŠ±å‘³ç²¾ | ENTERPRISE | LISTED | æŒ‚ç‰Œä»· |
| ç›Šæµ·å˜‰é‡Œ | ENTERPRISE | PURCHASE | æ”¶è´­ä»· |

---

## ğŸ¤– AI æ™ºèƒ½è¯†åˆ«

### è¯†åˆ«æµç¨‹

1. **Gemini API åˆ†æ**ï¼ˆä¼˜å…ˆï¼‰
   - AI ç›´æ¥è¾“å‡º `sourceType`ã€`subType`ã€`geoLevel`
   
2. **æ™ºèƒ½æ˜ å°„**ï¼ˆAI è¾“å‡ºä¸å®Œæ•´æ—¶ï¼‰
   - `mapSourceType()`: åŒ¹é…æ¸¯å£/ä¼ä¸šå…³é”®è¯
   - `mapSubType()`: ä»å¤‡æ³¨æ¨æ–­ï¼ˆå¹³èˆ±/åˆ°æ¸¯/æˆäº¤ï¼‰
   - `mapGeoLevel()`: ä»ä½ç½®æ¨æ–­ï¼ˆä¼ä¸š/æ¸¯å£/åŸå¸‚ï¼‰

3. **é‡‡é›†ç‚¹å…³è”**ï¼ˆè‡ªåŠ¨ï¼‰
   - åŒ¹é…ç³»ç»Ÿä¸­çš„ `CollectionPoint` é…ç½®
   - å…³è”è¡Œæ”¿åŒºåˆ’ä»£ç 

### è¯†åˆ«å…³é”®è¯

**æ¸¯å£**:
```
é”¦å·æ¸¯ã€é²…é±¼åœˆã€åŒ—è‰¯æ¸¯ã€å¤§è¿æ¸¯ã€è¥å£æ¸¯ã€ä¸¹ä¸œæ¸¯ã€
ç§¦çš‡å²›æ¸¯ã€å”å±±æ¸¯ã€å¤©æ´¥æ¸¯ã€é’å²›æ¸¯ã€æ—¥ç…§æ¸¯
```

**ä¼ä¸š**:
```
æ¢…èŠ±å‘³ç²¾ã€ä¸­ç²®ç”ŸåŒ–ã€ç›Šæµ·å˜‰é‡Œã€è±¡å±¿ç”ŸåŒ–ã€å‰æ—ç‡ƒæ–™ä¹™é†‡ã€
é•¿æ˜¥å¤§æˆã€å…¬ä¸»å²­é»„é¾™ã€å˜‰å‰ã€å›½æŠ•ç”Ÿç‰©ã€è¯ºç»´ä¿¡ã€è¥¿ç‹ã€é²æ´²
```

---

## ğŸ“Š å‰ç«¯å±•ç¤º

### Aç±»è¡Œæƒ…ç»„ä»¶ (6ä¸ª)

> **2026-01-22 æ›´æ–°**: ç»ä»£ç éªŒè¯ï¼Œç»„ä»¶æ•°é‡ä»7ä¸ªæ›´æ­£ä¸º6ä¸ª

| ç»„ä»¶ | åŠŸèƒ½ |
| :--- | :--- |
| [MarketData.tsx](file:///Users/mac/Progame/CTBMS/apps/web/src/features/market-intel/components/MarketData.tsx) | Aç±»è¡Œæƒ…ä¸»ç•Œé¢ |
| [FilterPanel.tsx](file:///Users/mac/Progame/CTBMS/apps/web/src/features/market-intel/components/market-data/FilterPanel.tsx) | å¤šç»´ç­›é€‰é¢æ¿ |
| [AdvancedPointSelector.tsx](file:///Users/mac/Progame/CTBMS/apps/web/src/features/market-intel/components/market-data/AdvancedPointSelector.tsx) | é‡‡é›†ç‚¹é€‰æ‹©å™¨ |
| [TrendChart.tsx](file:///Users/mac/Progame/CTBMS/apps/web/src/features/market-intel/components/market-data/TrendChart.tsx) | ä»·æ ¼è¶‹åŠ¿å›¾ |
| [ComparisonPanel.tsx](file:///Users/mac/Progame/CTBMS/apps/web/src/features/market-intel/components/market-data/ComparisonPanel.tsx) | å¤šç‚¹å¯¹æ¯” |
| [DataGrid.tsx](file:///Users/mac/Progame/CTBMS/apps/web/src/features/market-intel/components/market-data/DataGrid.tsx) | æ•°æ®ç½‘æ ¼ |

### ä»·æ ¼å±•ç¤ºåˆ†ç»„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š ä»·æ ¼æ•°æ® (Aç±»)                                    [5æ¡]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ­ ä¼ä¸šæ”¶è´­ä»·                                      [2æ¡]     â”‚
â”‚   æ¢…èŠ±å‘³ç²¾ [æŒ‚ç‰Œä»·]    2750 å…ƒ/å¨  â†’                         â”‚
â”‚   ç›Šæµ·å˜‰é‡Œ [æ”¶è´­ä»·]    2720 å…ƒ/å¨  â†‘5                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš“ æ¸¯å£ä»·æ ¼                                        [2æ¡]     â”‚
â”‚   é”¦å·æ¸¯ [å¹³èˆ±ä»·]      2680 å…ƒ/å¨  â†“10                       â”‚
â”‚   é²…é±¼åœˆ [åˆ°æ¸¯ä»·]      2675 å…ƒ/å¨  â†“8                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸŒ åœ°åŸŸå¸‚åœºä»·                                      [1æ¡]     â”‚
â”‚   ä¸œåŒ— [å¸‚åœºä»·]        2650 å…ƒ/å¨  â†’                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” API æŸ¥è¯¢èƒ½åŠ›

### ä»·æ ¼æ•°æ®æŸ¥è¯¢

| Hook | åŠŸèƒ½ |
| :--- | :--- |
| `usePriceData()` | ä»·æ ¼åˆ—è¡¨ï¼ˆæ”¯æŒå¤šç»´ç­›é€‰ï¼‰ |
| `usePriceTrend()` | å•ç‚¹è¶‹åŠ¿ |
| `usePriceByCollectionPoint()` | æŒ‰é‡‡é›†ç‚¹æŸ¥è¯¢ |
| `usePriceByRegion()` | æŒ‰è¡Œæ”¿åŒºåˆ’èšåˆ |
| `useMultiPointCompare()` | å¤šé‡‡é›†ç‚¹å¯¹æ¯” |

### ç­›é€‰ç»´åº¦

- æ—¥æœŸèŒƒå›´
- å“ç§
- ä¸»ä½“ç±»å‹ï¼ˆä¼ä¸š/æ¸¯å£/åœ°åŸŸï¼‰
- å­ç±»å‹ï¼ˆæŒ‚ç‰Œä»·/æˆäº¤ä»·/å¹³èˆ±ä»·ç­‰ï¼‰
- é‡‡é›†ç‚¹
- è¡Œæ”¿åŒºåˆ’

---

## âœ… éªŒè¯ç»“æœ

| é¡¹ç›® | çŠ¶æ€ |
| :--- | :---: |
| Prisma è¿ç§» | âœ… |
| ç±»å‹å®šä¹‰ | âœ… |
| API ç¼–è¯‘ | âœ… |
| å‰ç«¯ç¼–è¯‘ | âœ… |
| AI è¯†åˆ«é›†æˆ | âœ… |

---

## ğŸ”® åç»­è¿­ä»£å»ºè®®

1. **åœ°å›¾ä»·æ ¼å±•ç¤º**
   - åˆ©ç”¨ `longitude`/`latitude` åœ¨åœ°å›¾ä¸Šæ ‡æ³¨ä»·æ ¼ç‚¹
   
2. **ä¼ä¸šä»·æ ¼è¶‹åŠ¿å›¾**
   - æŒ‰ä¼ä¸šç»´åº¦å±•ç¤ºå†å²ä»·æ ¼èµ°åŠ¿

3. **æ¸¯å£ä»·æ ¼ç›‘æ§**
   - ä¸“é—¨çš„æ¸¯å£ä»·æ ¼ Dashboard

4. **ä»·æ ¼é¢„è­¦**
   - å½“æŸä¼ä¸š/æ¸¯å£ä»·æ ¼å¼‚å¸¸æ³¢åŠ¨æ—¶è‡ªåŠ¨å‘Šè­¦

---

*Walkthrough ç”Ÿæˆæ—¶é—´: 2026-01-19*
*æœ€åæ›´æ–°: 2026-01-22*
